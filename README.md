# About the contents
nwn-logparser is a Java8 program that reads and analyses the nwclientLog[1234].txt files created by the Neverwinter Nights game, also known as a combat log parser.

## Background
I first started on this parser back in 2010 duing my first year of university to apply the skills and tools I learned on a personal application. It motivated me to learn beyond the scope of my classes and provided a playground where I knew all the ins and outs of the application. When I later learned about code structure, patterns, and clean coding, I came to realize the horrible state the project was in.

It has now been years since I last did any work on the project. I have been thinking of opensourcing it for some time now, but for that to be any useful the code has to be cleaned.

This is currently a project where I try to apply the teachings of Robert C. Martin as I go through his book Clean Code.

## Project structure

#### Overview
![](https://docs.google.com/drawings/d/17bf_vWNbBJl0Wu0EDZa2jcffKLqHv-8Mq3kIPPY-nz8/pub?w=1194&h=402 "")
The parser runs as a third party application and analyzes the game's combat log output as it is written to disk (see Setup for instructions on how to enable). As such, the logs is the connection between the two appliations; the game writes and the parser reads. Whenever a new logfile is created, or a logfile is modified, the parser is notified of the change and reads the input. Logfiles are assumed to grow to a certain size, keeping the history unmodified during the life of the game application. Logfiles 1-3 have a size limit, while the 4th grows indefinitely. These assumptions are based on observed application behavior, and are assumed to hold true as the game keeps write privileges while running.

Prior to Java7 the parser polled every second for file changes, which is a suboptimal solution but the best I could come up with using Java6. With Java7 the WatchService interface was introduced to provide path observation, and this has now been incorporated into the parser through the PathWatcher class.

The PathWatcher observes the log directory and notifies the Model of changes. The Model does all the work on the data, parsing new input and keeps an updated data structure. The View is notified whenever the data structure is updated to refresh its display.

#### View
The Swing GUI was initially autogenerated by the netbeans GUI designer. This view is currently broken; the data structure has changed and functionality has been extracted, leaving the view with broken methods and loose ends. The current plan is to display in the command line first, then (maybe) write a new GUI.

#### Editors
nwn-logparser contains project files for both NetBeans, SublimeText and IntelliJ IDEA.

## Setup

Writing to disk is enabled by the ClientEntireChatWindowLogging switch located in NWN/nwnplayer.ini:
```
[Game Options]
ClientChatLogging=0
ClientEntireChatWindowLogging=1
```
